<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Pemetaan TPS3R - Kelurahan Kaligawe 2025</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <style>
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      padding: 0;
      font-family: Arial, Helvetica, sans-serif;
      background: linear-gradient(to bottom, #ffb35c, #ffe173);
      min-height: 100vh;
    }
    .container {
      max-width: 1200px;
      margin: auto;
      padding: 30px;
    }
    .header {
      background: #c70000;
      color: white;
      border-radius: 20px;
      padding: 30px 10px;
      text-align: center;
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
      margin-bottom: 40px;
    }
    .header h1 {
      margin: 0;
      font-size: 36px;
      font-weight: 900;
    }
    .header p {
      margin: 5px 0 0;
      font-size: 20px;
    }
    .box {
      background: white;
      padding: 25px;
      border-radius: 20px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
      margin-bottom: 40px;
    }
    .box-title {
      font-size: 20px;
      color: #c70000;
      font-weight: bold;
      margin-bottom: 10px;
    }
    .deskripsi-area {
      width: 100%;
      height: 120px;
      border: 2px solid #f0a0a0;
      border-radius: 15px;
      padding: 15px;
      font-size: 14px;
      resize: none;
    }
    .grid-3 {
      display: grid;
      grid-template-columns: 2fr 1fr;
      gap: 20px;
      margin-bottom: 40px;
      align-items: stretch;
    }
    @media (max-width: 900px) {
      .grid-3 {
        grid-template-columns: 1fr;
      }
    }
    .sub-box {
      background: white;
      border-radius: 20px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }
    .sub-box.map-box {
      display: flex;
      flex-direction: column;
    }
    .sub-header {
      background: #c70000;
      color: white;
      padding: 14px 18px;
      font-weight: bold;
      font-size: 18px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      cursor: pointer;
      user-select: none;
    }
    .dropdown-content {
      background: #fff0f0;
      padding: 10px 20px;
      display: none;
    }
    .dropdown-content.show {
      display: block;
    }
    .dropdown-content div {
      padding: 10px 12px;
      font-weight: bold;
      cursor: pointer;
      color: #c70000;
      border-radius: 8px;
      transition: background 0.2s;
      margin-bottom: 5px;
    }
    .dropdown-content div:hover {
      background: #ffe0e0;
    }
    .dropdown-content div.active {
      background: #c70000;
      color: white;
    }
    #map {
      width: 100%;
      flex: 1;
      min-height: 400px;
    }
    .legend-list {
      padding: 15px 20px;
      font-size: 14px;
      color: #c70000;
    }
    .legend-item {
      display: flex;
      align-items: center;
      margin-bottom: 10px;
      font-weight: bold;
    }
    .legend-item input[type="checkbox"] {
      margin-right: 10px;
      width: 18px;
      height: 18px;
      accent-color: #c70000;
      cursor: pointer;
    }
    .legend-item .color-box {
      width: 20px;
      height: 20px;
      border-radius: 4px;
      margin-right: 10px;
      border: 1px solid #999;
    }
    .legend-item .zoom-btn {
      margin-left: auto;
      background: #c70000;
      color: white;
      border: none;
      border-radius: 5px;
      padding: 4px 10px;
      font-size: 11px;
      cursor: pointer;
      font-weight: bold;
    }
    .legend-item .zoom-btn:hover {
      background: #a00000;
    }
    .legend-section {
      border-top: 1px solid #f0a0a0;
    }
    .legend-section-title {
      padding: 10px 20px;
      font-weight: bold;
      color: #c70000;
      font-size: 13px;
      background: #fff5f5;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .legend-section-title .zoom-btn {
      background: #c70000;
      color: white;
      border: none;
      border-radius: 5px;
      padding: 4px 10px;
      font-size: 11px;
      cursor: pointer;
      font-weight: bold;
    }
    .legend-section-title .zoom-btn:hover {
      background: #a00000;
    }
    .anggota-box {
      background: white;
      border-radius: 20px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
      margin-bottom: 40px;
      overflow: hidden;
    }
    .anggota-grid {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 30px;
      padding: 30px;
    }
    .anggota-row {
      display: flex;
      justify-content: center;
      gap: 30px;
      flex-wrap: wrap;
    }
    .anggota {
      width: 130px;
      text-align: center;
    }
    .anggota-img {
      width: 100%;
      height: 120px;
      border-radius: 15px;
      background: #d9f2ff;
      object-fit: cover;
    }
    .anggota p {
      color: #c70000;
      margin: 5px 0 0;
      font-weight: bold;
      font-size: 13px;
    }
    .hidden {
      display: none !important;
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="header">
      <h1>PEMETAAN UMKM RONGSOKAN DAN POTENSI TPS3R</h1>
      <p>Kelurahan Kaligawe 2025</p>
    </div>

    <div class="box">
      <div class="box-title">WebGIS ini menampilkan pemetaan lokasi UMKM rongsokan beserta analisis service area untuk melihat jangkauan pelayanannya, serta peta potensi pembangunan TPS3R sebagai dasar perencanaan pengelolaan sampah yang lebih efektif dan berkelanjutan.
</div>
    </div>

    <div class="grid-3">
      <div class="sub-box map-box" id="map-container">
        <div class="sub-header" id="layer-header" onclick="toggleDropdown()">
          <span id="current-layer-text">Jenis Layer: OpenStreetMap</span>
          <span id="dropdown-arrow">â–¼</span>
        </div>
        <div class="dropdown-content" id="dropdown-menu">
          <div id="opt-osm" class="active" onclick="changeLayer('osm')">OpenStreetMap</div>
          <div id="opt-satellite" onclick="changeLayer('satellite')">Satellite</div>
          <div id="opt-streets" onclick="changeLayer('streets')">Streets</div>
        </div>
        <div id="map"></div>
      </div>

      <div class="sub-box" id="legend-container">
        <div class="sub-header" style="cursor: default;">Pilih Peta</div>
        <div class="legend-list">
          <label class="legend-item">
            <input type="checkbox" id="chk-eksisting" onchange="togglePeta('eksisting')">
            Lokasi UMKM Rongsokan
            <button class="zoom-btn" onclick="event.preventDefault(); zoomToLayer('eksisting')">Zoom</button>
          </label>
          <label class="legend-item">
            <input type="checkbox" id="chk-service" onchange="togglePeta('service')">
            Service Area UMKM Rongsokan
            <button class="zoom-btn" onclick="event.preventDefault(); zoomToLayer('service')">Zoom</button>
          </label>
          <label class="legend-item">
            <input type="checkbox" id="chk-potensi" onchange="togglePeta('potensi')">
            Lokasi Potensial TPS3R
            <button class="zoom-btn" onclick="event.preventDefault(); zoomToLayer('potensi')">Zoom</button>
          </label>
          <label class="legend-item">
            <input type="checkbox" id="chk-batas" onchange="toggleBatasAdmin()">
            Batas Administrasi
            <button class="zoom-btn" onclick="event.preventDefault(); zoomToLayer('batas')">Zoom</button>
          </label>
          <label class="legend-item">
            <input type="checkbox" id="chk-rw" onchange="toggleBatasRW()">
            Batas RW
            <button class="zoom-btn" onclick="event.preventDefault(); zoomToLayer('rw')">Zoom</button>
          </label>
        </div>

        <div class="sub-header" style="cursor: default;">Legenda</div>
        
        <div id="legend-eksisting" class="legend-section hidden">
          <div class="legend-section-title">
            Eksisting UMKM Rongsokan
            <button class="zoom-btn" onclick="zoomToLayer('eksisting')">Zoom All</button>
          </div>
          <div class="legend-list">
            <label class="legend-item">
              <input type="checkbox" id="chk-eks-kurang" onchange="toggleKelasLayer('eksisting', 'kurang')">
              <div class="color-box" style="background: rgba(231, 76, 60, 0.5);"></div>
              Kurang Sesuai
              <button class="zoom-btn" onclick="event.preventDefault(); zoomToKelas('eksisting', 'kurang')">Zoom</button>
            </label>
            <label class="legend-item">
              <input type="checkbox" id="chk-eks-cukup" onchange="toggleKelasLayer('eksisting', 'cukup')">
              <div class="color-box" style="background: rgba(241, 196, 15, 0.5);"></div>
              Cukup Sesuai
              <button class="zoom-btn" onclick="event.preventDefault(); zoomToKelas('eksisting', 'cukup')">Zoom</button>
            </label>
          </div>
        </div>

        <div id="legend-service" class="legend-section hidden">
          <div class="legend-section-title">
            Service Area UMKM
            <button class="zoom-btn" onclick="zoomToLayer('service')">Zoom All</button>
          </div>
          <div class="legend-list">
            <label class="legend-item">
              <input type="checkbox" id="chk-srv-1" onchange="toggleKelasLayer('service', '1')">
              <div class="color-box" style="background: rgba(231, 76, 60, 0.5);"></div>
              Kelas 1 (0-100m)
              <button class="zoom-btn" onclick="event.preventDefault(); zoomToKelas('service', '1')">Zoom</button>
            </label>
            <label class="legend-item">
              <input type="checkbox" id="chk-srv-2" onchange="toggleKelasLayer('service', '2')">
              <div class="color-box" style="background: rgba(241, 196, 15, 0.5);"></div>
              Kelas 2 (100-250m)
              <button class="zoom-btn" onclick="event.preventDefault(); zoomToKelas('service', '2')">Zoom</button>
            </label>
            <label class="legend-item">
              <input type="checkbox" id="chk-srv-3" onchange="toggleKelasLayer('service', '3')">
              <div class="color-box" style="background: rgba(39, 174, 96, 0.5);"></div>
              Kelas 3 (>250m)
              <button class="zoom-btn" onclick="event.preventDefault(); zoomToKelas('service', '3')">Zoom</button>
            </label>
          </div>
        </div>

        <div id="legend-potensi" class="legend-section hidden">
          <div class="legend-section-title">
            Potensi TPS3R
            <button class="zoom-btn" onclick="zoomToLayer('potensi')">Zoom All</button>
          </div>
          <div class="legend-list">
            <label class="legend-item">
              <input type="checkbox" id="chk-pot-kurang" onchange="toggleKelasLayer('potensi', 'kurang')">
              <div class="color-box" style="background: rgba(231, 76, 60, 0.5);"></div>
              Kurang Berpotensi
              <button class="zoom-btn" onclick="event.preventDefault(); zoomToKelas('potensi', 'kurang')">Zoom</button>
            </label>
            <label class="legend-item">
              <input type="checkbox" id="chk-pot-cukup" onchange="toggleKelasLayer('potensi', 'cukup')">
              <div class="color-box" style="background: rgba(241, 196, 15, 0.5);"></div>
              Cukup Berpotensi
              <button class="zoom-btn" onclick="event.preventDefault(); zoomToKelas('potensi', 'cukup')">Zoom</button>
            </label>
            <label class="legend-item">
              <input type="checkbox" id="chk-pot-sangat" onchange="toggleKelasLayer('potensi', 'sangat')">
              <div class="color-box" style="background: rgba(39, 174, 96, 0.5);"></div>
              Sangat Berpotensi
              <button class="zoom-btn" onclick="event.preventDefault(); zoomToKelas('potensi', 'sangat')">Zoom</button>
            </label>
          </div>
        </div>

        <div id="legend-batas" class="legend-section hidden">
          <div class="legend-section-title">
            Batas Wilayah
            <button class="zoom-btn" onclick="zoomToLayer('batas')">Zoom</button>
          </div>
          <div class="legend-list">
            <label class="legend-item">
              <div class="color-box" style="background: transparent; border: 3px solid #333;"></div>
              Batas Administrasi Kelurahan
            </label>
          </div>
        </div>

        <div id="legend-rw" class="legend-section hidden">
          <div class="legend-section-title">
            Batas RW & Kawasan Industri
            <button class="zoom-btn" onclick="zoomToLayer('rw')">Zoom</button>
          </div>
          <div class="legend-list" id="rw-legend-items">
          </div>
        </div>

      </div>
    </div>

    <div class="anggota-box">
      <div class="sub-header" style="cursor: default;">Anggota</div>
      <div class="anggota-grid" id="anggota-container">
        <div class="anggota-row" id="row1"></div>
        <div class="anggota-row" id="row2"></div>
      </div>
    </div>
  </div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/proj4js/2.9.0/proj4.min.js"></script>
  <script>
const geoJSONData = {
  umkmKurangSesuai: {"type":"FeatureCollection","name":"UMKM_Rongsokan_Kurang_Sesuai","crs":{"type":"name","properties":{"name":"urn:ogc:def:crs:OGC:1.3:CRS84"}},"features":[{"type":"Feature","properties":{"OBJECTID":3,"pointid":3,"grid_code":1},"geometry":{"type":"Point","coordinates":[110.44682059400009,-6.966567519999899]}},{"type":"Feature","properties":{"OBJECTID":4,"pointid":4,"grid_code":1},"geometry":{"type":"Point","coordinates":[110.44732759400011,-6.966749519999951]}},{"type":"Feature","properties":{"OBJECTID":5,"pointid":5,"grid_code":1},"geometry":{"type":"Point","coordinates":[110.44706759400009,-6.9668145199999]}},{"type":"Feature","properties":{"OBJECTID":6,"pointid":6,"grid_code":1},"geometry":{"type":"Point","coordinates":[110.44808159400014,-6.967503519999809]}},{"type":"Feature","properties":{"OBJECTID":7,"pointid":7,"grid_code":1},"geometry":{"type":"Point","coordinates":[110.4483025940001,-6.967568519999929]}}]},
  umkmCukupSesuai: {"type":"FeatureCollection","name":"UMKM_Rongsokan_Cukup_Sesuai","crs":{"type":"name","properties":{"name":"urn:ogc:def:crs:OGC:1.3:CRS84"}},"features":[{"type":"Feature","properties":{"OBJECTID":1,"pointid":1,"grid_code":2},"geometry":{"type":"Point","coordinates":[110.45013559400007,-6.96385051999988]}},{"type":"Feature","properties":{"OBJECTID":2,"pointid":2,"grid_code":2},"geometry":{"type":"Point","coordinates":[110.44910859400022,-6.964045519999956]}}]},
  serviceArea1: {"type":"FeatureCollection","name":"Service_Area_1","crs":{"type":"name","properties":{"name":"urn:ogc:def:crs:EPSG::32749"}},"features":[{"type":"Feature","properties":{"OBJECTID":1,"FacilityID":0,"Name":"0 - 300,344562976084","FromBreak":0,"ToBreak":300.344562976,"Shape_Leng":3057.65552874,"Shape_Area":265312.5},"geometry":{"type":"MultiPolygon","coordinates":[[[[439027.1657999996,9230033.8644],[439227.1657999996,9229858.8644],[439227.1657999996,9229733.8644],[439152.1657999996,9229683.8644],[438577.1657999996,9229808.8644],[438527.1657999996,9229883.8644],[438627.1657999996,9230008.8644],[438802.1657999996,9229983.8644],[438852.1657999996,9230033.8644],[439027.1657999996,9230033.8644]]],[[[439377.1657999996,9230133.8644],[439202.1657999996,9230058.8644],[439052.1657999996,9230083.8644],[439002.1657999996,9230158.8644],[439027.1657999996,9230233.8644],[439177.1657999996,9230283.8644],[439227.1657999996,9230383.8644],[439327.1657999996,9230433.8644],[439327.1657999996,9230458.8644],[439452.1657999996,9230358.8644],[439377.1657999996,9230133.8644]]]]}}]},
  serviceArea2: {"type":"FeatureCollection","name":"Service_Area_2","crs":{"type":"name","properties":{"name":"urn:ogc:def:crs:EPSG::32749"}},"features":[{"type":"Feature","properties":{"OBJECTID":1,"FacilityID":0,"Name":"0 - 300,344562976084","FromBreak":0,"ToBreak":300.344562976,"Shape_Leng":6820.68417482,"Shape_Area":526250},"geometry":{"type":"MultiPolygon","coordinates":[[[[439502.1657999996,9230558.8644],[439602.1657999996,9230358.8644],[439502.1657999996,9230033.8644],[439352.1657999996,9229958.8644],[439402.1657999996,9229808.8644],[439352.1657999996,9229633.8644],[439152.1657999996,9229533.8644],[438902.1657999996,9229533.8644],[438477.1657999996,9229683.8644],[438377.1657999996,9229883.8644],[438427.1657999996,9230058.8644],[438627.1657999996,9230158.8644],[438852.1657999996,9230158.8644],[438952.1657999996,9230383.8644],[439077.1657999996,9230408.8644],[439177.1657999996,9230558.8644],[439327.1657999996,9230583.8644],[439327.1657999996,9230608.8644],[439502.1657999996,9230558.8644]],[[439052.1657999996,9230083.8644],[439202.1657999996,9230058.8644],[439377.1657999996,9230133.8644],[439452.1657999996,9230358.8644],[439327.1657999996,9230458.8644],[439327.1657999996,9230433.8644],[439227.1657999996,9230383.8644],[439177.1657999996,9230283.8644],[439027.1657999996,9230233.8644],[439002.1657999996,9230158.8644],[439052.1657999996,9230083.8644]],[[438852.1657999996,9230033.8644],[438802.1657999996,9229983.8644],[438627.1657999996,9230008.8644],[438527.1657999996,9229883.8644],[438577.1657999996,9229808.8644],[439152.1657999996,9229683.8644],[439227.1657999996,9229733.8644],[439227.1657999996,9229858.8644],[439027.1657999996,9230033.8644],[438852.1657999996,9230033.8644]]]]}}]},
  serviceArea3: {"type":"FeatureCollection","name":"Service_Area_3","crs":{"type":"name","properties":{"name":"urn:ogc:def:crs:EPSG::32749"}},"features":[{"type":"Feature","properties":{"OBJECTID":1,"FacilityID":0,"Name":"0 - 300,344562976084","FromBreak":0,"ToBreak":300.344562976,"Shape_Leng":8987.28427863,"Shape_Area":1097500},"geometry":{"type":"MultiPolygon","coordinates":[[[[439752.1657999996,9230658.8644],[439852.1657999996,9230358.8644],[439777.1657999996,9230033.8644],[439627.1657999996,9229833.8644],[439627.1657999996,9229633.8644],[439552.1657999996,9229483.8644],[439452.1657999996,9229383.8644],[439152.1657999996,9229283.8644],[438752.1657999996,9229308.8644],[438327.1657999996,9229483.8644],[438227.1657999996,9229583.8644],[438127.1657999996,9229883.8644],[438227.1657999996,9230208.8644],[438477.1657999996,9230383.8644],[438677.1657999996,9230408.8644],[438702.1657999996,9230483.8644],[438902.1657999996,9230608.8644],[439027.1657999996,9230758.8644],[439177.1657999996,9230833.8644],[439327.1657999996,9230833.8644],[439327.1657999996,9230858.8644],[439652.1657999996,9230758.8644],[439752.1657999996,9230658.8644]],[[438477.1657999996,9229683.8644],[438902.1657999996,9229533.8644],[439152.1657999996,9229533.8644],[439352.1657999996,9229633.8644],[439402.1657999996,9229808.8644],[439352.1657999996,9229958.8644],[439502.1657999996,9230033.8644],[439602.1657999996,9230358.8644],[439502.1657999996,9230558.8644],[439327.1657999996,9230608.8644],[439327.1657999996,9230583.8644],[439177.1657999996,9230558.8644],[439077.1657999996,9230408.8644],[438952.1657999996,9230383.8644],[438852.1657999996,9230158.8644],[438627.1657999996,9230158.8644],[438427.1657999996,9230058.8644],[438377.1657999996,9229883.8644],[438477.1657999996,9229683.8644]]]]}}]},
  tps3rKurang: {"type":"FeatureCollection","name":"AREA_TPS3R_Kurang_Berpotensi","crs":{"type":"name","properties":{"name":"urn:ogc:def:crs:EPSG::32749"}},"features":[{"type":"Feature","properties":{"Id":4,"gridcode":1},"geometry":{"type":"MultiPolygon","coordinates":[[[[439274.0920015035,9230647.8081],[439269.99200150353,9230647.8081],[439267.9420015035,9230653.059285607],[439265.8920015035,9230647.8081],[439236.29568955285,9230671.487483086],[439228.99200150353,9230680.608099999],[439296.6791627584,9230677.513393274],[439340.58506028034,9230642.986771265],[439377.8663697896,9230594.369965235],[439386.7638627705,9230568.984511437],[439379.88821732375,9230559.736270012],[439356.7864915547,9230573.37526385],[439304.9201402364,9230621.236270012],[439274.0920015035,9230647.8081]]]]}},{"type":"Feature","properties":{"Id":5,"gridcode":1},"geometry":{"type":"MultiPolygon","coordinates":[[[[439204.39200150355,9230533.0081],[439132.4495011984,9230597.850642266],[439132.83249985566,9230607.514476648],[439095.8201402365,9230637.636270013],[439079.438720864,9230645.367312493],[439079.15450608125,9230652.538746515],[439143.87883927213,9230669.498386255],[439177.66386277066,9230674.536270013],[439196.19200150354,9230676.5081],[439202.42014023644,9230674.536270013],[439230.96386277064,9230649.779929986],[439254.68131424766,9230634.464331688],[439274.9467103658,9230609.563100304],[439206.5201402365,9230534.979929985],[439204.39200150355,9230533.0081]]]]}},{"type":"Feature","properties":{"Id":8,"gridcode":1},"geometry":{"type":"MultiPolygon","coordinates":[[[[439343.79200150346,9230410.0081],[439338.7931871114,9230411.411656823],[439342.38844467973,9230415.006914392],[439343.79200150346,9230410.0081]]]]}},{"type":"Feature","properties":{"Id":9,"gridcode":1},"geometry":{"type":"MultiPolygon","coordinates":[[[[439384.79200150346,9230369.0081],[439362.76732651563,9230387.983425012],[439343.79200150346,9230410.0081],[439355.1899964986,9230407.880649438],[439388.89200150344,9230389.5081],[439387.2174302754,9230378.882671228],[439384.79200150346,9230369.0081]]]]}},{"type":"Feature","properties":{"Id":11,"gridcode":1},"geometry":{"type":"MultiPolygon","coordinates":[[[[439048.5920015036,9230315.7081],[439037.2353593528,9230317.497908654],[439049.78616654273,9230335.675955834],[439069.6980928122,9230321.928043237],[439050.26657273166,9230318.13352877],[439048.5920015036,9230315.7081]]]]}},{"type":"Feature","properties":{"Id":12,"gridcode":1},"geometry":{"type":"MultiPolygon","coordinates":[[[[439298.6920015035,9230159.9081],[439295.5068315206,9230162.652277246],[439282.9321260152,9230196.894309105],[439319.1920015035,9230205.0081],[439312.88954026083,9230190.810561242],[439298.6920015035,9230159.9081]]]]}},{"type":"Feature","properties":{"Id":13,"gridcode":1},"geometry":{"type":"MultiPolygon","coordinates":[[[[439163.39200150355,9229897.5081],[439087.45917069307,9229922.14857699],[439088.0770234763,9229952.424426904],[439083.4010240256,9229956.917122522],[439078.95374771947,9230025.077933375],[439066.9841325461,9230071.78287417],[439073.99278275366,9230078.51669375],[439063.7955217063,9230158.295151392],[439217.1998094259,9230186.517122522],[439254.7519456564,9230157.233428063],[439169.50102402555,9229911.89914004],[439163.39200150355,9229897.5081]]]]}}]},
  tps3rCukup: {"type":"FeatureCollection","name":"AREA_TPS3R_Cukup_Berpotensi","crs":{"type":"name","properties":{"name":"urn:ogc:def:crs:EPSG::32749"}},"features":[{"type":"Feature","properties":{"Id":2,"gridcode":2},"geometry":{"type":"MultiPolygon","coordinates":[[[[439269.99200150353,9230647.8081],[439265.8920015035,9230647.8081],[439267.9420015035,9230653.059285607],[439269.99200150353,9230647.8081]]]]}},{"type":"Feature","properties":{"Id":10,"gridcode":2},"geometry":{"type":"MultiPolygon","coordinates":[[[[439274.0920015035,9230647.8081],[439304.9201402364,9230621.236270012],[439356.7864915547,9230573.37526385],[439379.88821732375,9230559.736270012],[439386.7638627705,9230568.984511437],[439377.8663697896,9230594.369965235],[439340.58506028034,9230642.986771265],[439296.6791627584,9230677.513393274],[439228.99200150353,9230680.608099999],[439194.59012619837,9230707.229493966],[439177.61900650844,9230723.535105005],[439167.57401902066,9230733.990101876],[439130.3305589377,9230769.773043312],[439081.31536423555,9230857.453538384],[439070.53860031953,9230888.938693108],[439144.9010240256,9230912.299100937],[439161.3829789816,9230916.31709906],[439206.83081833704,9230931.87307445],[439260.22021805623,9230943.88271109],[439347.1816835103,9230956.59054208],[439417.35451981396,9230958.022641888],[439415.5010240254,9230867.199100938],[439411.4361207661,9230618.247353997],[439406.6753511128,9230462.696378198],[439397.0278764424,9230413.27766482],[439388.89200150344,9230389.5081],[439355.1899964986,9230407.880649438],[439343.79200150346,9230410.0081],[439342.38844467973,9230415.006914392],[439338.7931871114,9230411.411656823],[439343.79200150346,9230410.0081],[439362.76732651563,9230387.983425012],[439384.79200150346,9230369.0081],[439373.11930100294,9230338.336238733],[439323.5888536153,9230380.337715784],[439306.5006822286,9230398.780521264],[439251.62014023645,9230449.036270013],[439206.5561128317,9230489.268708672],[439220.6356614767,9230504.464408746],[439228.3641389547,9230511.62520739],[439292.4613603292,9230604.773552576],[439293.090974587,9230620.657768121],[439276.0638627706,9230641.579929987],[439274.0920015035,9230647.8081]]]]}},{"type":"Feature","properties":{"Id":14,"gridcode":2},"geometry":{"type":"MultiPolygon","coordinates":[[[[438507.65658536647,9230446.908100002],[438524.05658536777,9230446.908100002],[438523.7920015054,9230451.008100003],[438532.256585367,9230451.008100003],[438540.45658536814,9230451.008100003],[438540.45658536814,9230455.108099999],[438538.4847397404,9230465.436270015],[438532.0745796757,9230493.979929985],[438495.35658536665,9230467.4081],[438493.3475863049,9230477.699108759],[438485.68435216695,9230500.087763852],[438453.55363012105,9230610.657949703],[438444.9675855227,9230627.32499148],[438434.5772591671,9230657.68104464],[438452.3749196129,9230663.456429163],[438585.0040619429,9230710.055860776],[438672.2997128088,9230747.825615562],[438779.55757337343,9230785.007093303],[438925.1974423006,9230838.328794159],[439048.46301389486,9230880.520362915],[439061.7387783611,9230853.156017557],[439100.0656078877,9230781.017106885],[439108.34756284487,9230768.799093118],[439118.1746502463,9230753.810360588],[439170.3396053845,9230703.691104382],[439196.4565853663,9230676.5081],[439177.9284466328,9230674.536270013],[439144.1434231354,9230669.498386256],[439079.4190899441,9230652.538746519],[439079.70330472756,9230645.367312493],[439096.0847240994,9230637.636270013],[439133.09708371945,9230607.514476648],[439132.7140850611,9230597.850642266],[439204.6565853674,9230533.008100005],[439182.22551389504,9230502.203515496],[439181.2790905563,9230486.32417971],[439206.8218853548,9230465.473399987],[439276.29128537886,9230403.742800012],[439314.6990063265,9230370.638878504],[439368.46345945075,9230322.60076205],[439348.38718534354,9230274.477500023],[439329.5912853796,9230231.773399988],[439319.4565853663,9230205.008100001],[439283.1967098797,9230196.894309105],[439295.77141538355,9230162.652277246],[439298.9565853672,9230159.9081],[439295.97617765144,9230150.723639552],[439226.9902493078,9229986.298537321],[439199.96425748616,9229923.834471766],[439175.3396084374,9229851.891721215],[439164.5130459387,9229780.699140038],[439081.9777111588,9229784.80101687],[439017.1966976719,9229809.31705996],[438989.36560788844,9229805.299140042],[438938.13800473884,9229797.813086573],[438881.371591622,9229827.056491723],[438837.8131893715,9229844.724729028],[438763.86557660997,9229866.71705996],[438690.39649320394,9229889.471008936],[438640.94757848606,9229899.599140039],[438595.0742928097,9229907.066800563],[438599.8655922478,9229936.499077482],[438607.6829220364,9229982.330103176],[438612.6344559258,9230025.92313296],[438606.02630582545,9230093.488112511],[438582.12591024116,9230173.851203028],[438562.9655922493,9230235.717122521],[438531.2489069542,9230339.473660912],[438526.0655844277,9230354.617122522],[438521.91164117586,9230380.134204736],[438504.90979619697,9230438.883145776],[438507.65658536647,9230446.908100002]],[[438897.15658536647,9230746.208099999],[438891.37976194173,9230740.657810083],[438867.1946354462,9230708.032261528],[438768.21994977724,9230627.839274468],[438814.82982908096,9230570.098692194],[438944.4767201012,9230616.652892174],[438935.9858738482,9230645.992578764],[438936.3101589745,9230661.883519616],[438919.4195866175,9230694.67110125],[438902.6915791109,9230729.151256053],[438897.15658536647,9230746.208099999],[438906.4739567349,9230747.850327171],[438899.4369350979,9230751.53681437],[438897.15658536647,9230746.208099999]],[[438893.05658536777,9230545.3081],[438911.4284153525,9230548.815646997],[438902.65939145815,9230554.865111412],[438852.6577030737,9230563.571761956],[438761.40949292853,9230567.18847796],[438676.1376133524,9230553.604662959],[438692.60514798947,9230501.591261925],[438724.0261776522,9230512.604193749],[438759.49628263246,9230521.898386255],[438811.6760647381,9230530.984313073],[438864.0920015052,9230533.008100001],[438864.0920015052,9230537.108099999],[438868.4565853672,9230537.108099999],[438878.331187875,9230539.533497492],[438888.6920015048,9230541.2081],[438888.6920015048,9230545.3081],[438893.05658536777,9230545.3081]],[[439048.85658536665,9230315.7081],[439050.5311565958,9230318.13352877],[439069.96267667506,9230321.928043237],[439050.05075040646,9230335.675955834],[439037.4999432154,9230317.497908657],[439048.85658536665,9230315.7081]],[[439163.6565853674,9229897.508100003],[439169.76560788695,9229911.89914004],[439255.0165295191,9230157.233428067],[439217.4643932888,9230186.517122522],[439064.06010556873,9230158.295151392],[439074.25736661814,9230078.516693752],[439067.2487164084,9230071.78287417],[439079.2183315819,9230025.077933375],[439083.66560788825,9229956.917122522],[439088.34160733875,9229952.424426904],[439087.7237545559,9229922.148576993],[439163.6565853674,9229897.508100003]]]]}}]},
  tps3rSangat: {"type":"FeatureCollection","name":"AREA_TPS3R_Sangat_Berpotensi","crs":{"type":"name","properties":{"name":"urn:ogc:def:crs:EPSG::32749"}},"features":[{"type":"Feature","properties":{"Id":1,"gridcode":3},"geometry":{"type":"MultiPolygon","coordinates":[[[[438897.17816978507,9230746.2585384],[438899.3884821916,9230751.423589766],[438899.4369350979,9230751.53681437],[438906.4739567349,9230747.850327171],[438897.15658536647,9230746.208099999],[438897.17816978507,9230746.2585384]]]]}},{"type":"Feature","properties":{"Id":3,"gridcode":3},"geometry":{"type":"MultiPolygon","coordinates":[[[[438897.15658536647,9230746.208099999],[438902.6915791109,9230729.151256053],[438919.4195866175,9230694.67110125],[438936.3101589745,9230661.883519616],[438935.9858738482,9230645.992578764],[438944.4767201012,9230616.652892174],[438814.82982908096,9230570.098692194],[438767.9553659139,9230627.839274468],[438867.1946354462,9230708.032261528],[438891.37976194173,9230740.657810083],[438897.15658536647,9230746.208099999]]]]}},{"type":"Feature","properties":{"Id":6,"gridcode":3},"geometry":{"type":"MultiPolygon","coordinates":[[[[438892.79200150375,9230545.3081],[438888.6920015038,9230545.3081],[438888.6920015038,9230541.2081],[438878.06660401233,9230539.533497492],[438868.1920015038,9230537.108099999],[438864.0920015038,9230537.108099999],[438864.0920015038,9230533.0081],[438811.41148087394,9230530.984313073],[438759.2316987695,9230521.898386255],[438723.76159378904,9230512.604193749],[438692.340564126,9230501.591261925],[438675.8730294885,9230553.604662957],[438761.1449090661,9230567.18847796],[438852.3931192101,9230563.571761956],[438902.39480759506,9230554.865111412],[438911.1638314903,9230548.815646997],[438892.79200150375,9230545.3081]]]]}},{"type":"Feature","properties":{"Id":7,"gridcode":3},"geometry":{"type":"MultiPolygon","coordinates":[[[[438523.792001504,9230446.9081],[438507.392001504,9230446.9081],[438501.52473828226,9230451.436862053],[438495.09200150403,9230467.4081],[438531.8099958125,9230493.979929985],[438538.2201558772,9230465.436270013],[438540.192001504,9230455.108099999],[438540.192001504,9230451.0081],[438531.992001504,9230451.0081],[438523.792001504,9230451.0081],[438523.792001504,9230446.9081]]]]}}]},
  batasRW: {"type":"FeatureCollection","name":"batas rw","crs":{"type":"name","properties":{"name":"urn:ogc:def:crs:EPSG::32749"}},"features":[{"type":"Feature","properties":{"Id":0,"RW":"RW 01"},"geometry":{"type":"MultiPolygon","coordinates":[[[[438920.010329713055398,9230836.587637763470411],[438923.788129147724248,9230827.088461374863982],[438928.330747213505674,9230818.229505589231849],[438933.049396920891013,9230809.027255985885859],[438951.946729857765604,9230787.25839146412909],[438945.032476963184308,9230781.415980516001582],[438708.798775327915791,9230579.878042709082365],[438691.794081555795856,9230566.266297668218613],[438704.446065237396397,9230535.034435307607055],[438671.799165720469318,9230524.137898445129395],[438633.168609886197373,9230511.244200060144067],[438616.247017840156332,9230499.95900921151042],[438592.257431312522385,9230495.258157530799508],[438530.120420148421545,9230496.649330442771316],[438450.507333887508139,9230490.963042370975018],[438425.547797251143493,9230575.452563662081957],[438400.212992202723399,9230645.767343822866678],[438419.468799447233323,9230653.84130384773016],[438442.593835105537437,9230660.841275138780475],[438592.656293255102355,9230713.84123576246202],[438677.906299487221986,9230751.84122914262116],[438831.802429381175898,9230805.242486272007227],[438920.010329713055398,9230836.587637763470411]]]]}},{"type":"Feature","properties":{"Id":0,"RW":"RW 03"},"geometry":{"type":"MultiPolygon","coordinates":[[[[438466.603976845159195,9230438.167195610702038],[438544.147522555082105,9230452.344297187402844],[438795.616457643336616,9230514.253748277202249],[438991.276223962544464,9230574.446576997637749],[438996.064354933216237,9230579.733322320505977],[439017.561891327961348,9230565.667091622948647],[439030.143593362881802,9230486.419525941833854],[439035.748503942391835,9230469.035569991916418],[438647.129789143218659,9230391.722756698727608],[438637.869353955960833,9230377.038352327421308],[438494.957791763707064,9230345.602664384990931],[438466.603976845159195,9230438.167195610702038]]]]}},{"type":"Feature","properties":{"Id":0,"RW":"RW 05"},"geometry":{"type":"MultiPolygon","coordinates":[[[[439074.833260859362781,9230323.014507247135043],[438944.209246318787336,9230297.77597245760262],[438534.606749074533582,9230214.551397550851107],[438513.932406703010201,9230281.986071432009339],[438752.471825524233282,9230327.072130858898163],[439063.904255771078169,9230389.45118061825633],[439074.833260859362781,9230323.014507247135043]]]]}},{"type":"Feature","properties":{"Id":0,"RW":"RW 06"},"geometry":{"type":"MultiPolygon","coordinates":[[[[439074.833260859362781,9230323.014507247135043],[439081.848099670372903,9230278.581213990226388],[439088.120532236993313,9230256.231565566733479],[439096.981649628840387,9230163.8450724221766],[438872.330101258121431,9230122.593233227729797],[438912.467473199591041,9229915.900319838896394],[438854.589753277599812,9229925.160755028948188],[438847.644426886923611,9229882.165877370163798],[438838.843849765136838,9229842.999956645071507],[438821.812514247372746,9229848.000135853886604],[438756.343754045665264,9229866.999888451769948],[438728.99997684918344,9229875.999850135296583],[438700.125047043897212,9229884.999989280477166],[438640.468790490180254,9229898.000052560120821],[438565.875063066370785,9229909.999882144853473],[438585.63128402736038,9230048.121780954301357],[438534.606749075464904,9230214.551397550851107],[438944.209246319718659,9230297.77597245760262],[439074.833260859362781,9230323.014507247135043]]]]}},{"type":"Feature","properties":{"Id":0,"RW":"RW 08"},"geometry":{"type":"MultiPolygon","coordinates":[[[[439320.515066462568939,9230205.14031452126801],[439227.501480975188315,9229983.026056576520205],[439099.600142620503902,9230012.998187653720379],[439107.140782703645527,9230083.245203163474798],[439106.347031114622951,9230107.851502381265163],[439096.981649628840387,9230163.8450724221766],[439320.515066462568939,9230205.14031452126801]]]]}},{"type":"Feature","properties":{"Id":0,"RW":"RW 10"},"geometry":{"type":"MultiPolygon","coordinates":[[[[439099.600142620503902,9230012.998187655583024],[439227.501480975188315,9229983.026056576520205],[439201.757943372242153,9229922.804310511797667],[439189.721045373938978,9229888.230537137016654],[439086.90011721663177,9229921.716755069792271],[439099.600142620503902,9230012.998187655583024]]]]}},{"type":"Feature","properties":{"Id":0,"RW":"RW 09"},"geometry":{"type":"MultiPolygon","coordinates":[[[[439096.981649628840387,9230163.8450724221766],[439106.347031114622951,9230107.851502381265163],[439107.140782703645527,9230083.245203163474798],[439099.600142620503902,9230012.998187655583024],[439091.330069500021636,9229953.557037092745304],[439005.152082167565823,9229965.452688040211797],[438905.284263884648681,9229952.891243489459157],[438872.330101258121431,9230122.593233227729797],[439096.981649628840387,9230163.8450724221766]]]]}},{"type":"Feature","properties":{"Id":0,"RW":"RW 07"},"geometry":{"type":"MultiPolygon","coordinates":[[[[438905.284263884648681,9229952.891243489459157],[439005.152082167565823,9229965.452688040211797],[439091.330069500021636,9229953.557037094607949],[439086.90011721663177,9229921.716755071654916],[439189.721045373938978,9229888.230537137016654],[439185.129457147791982,9229875.042045325040817],[439180.598044645041227,9229862.026176627725363],[439174.941644543781877,9229842.968460848554969],[439169.118725926615298,9229815.999040866270661],[439165.62204838078469,9229791.416817884892225],[439164.384626042097807,9229782.708115961402655],[439141.125041318126023,9229783.000039173290133],[439105.468829493969679,9229784.000048462301493],[439084.687458239495754,9229782.999838514253497],[439076.093804431147873,9229784.999962100759149],[439067.812541464343667,9229787.00000699236989],[439048.562553515657783,9229795.999852670356631],[439031.000020712614059,9229803.000017544254661],[439015.656341799534857,9229806.999858919531107],[439002.312534147873521,9229806.999957604333758],[438993.375036347657442,9229805.000021578744054],[438975.968785979785025,9229801.999968538060784],[438954.187462734058499,9229797.999936908483505],[438935.1249895747751,9229799.000008897855878],[438929.718780382536352,9229798.999982189387083],[438915.374966859817505,9229806.999946728348732],[438889.53135141171515,9229821.000001894310117],[438861.468789958395064,9229833.999938270077109],[438838.843849765136838,9229842.999956645071507],[438854.589753277599812,9229925.160755028948188],[438912.467473199591041,9229915.900319838896394],[438905.284263884648681,9229952.891243489459157]]]]}},{"type":"Feature","properties":{"Id":0,"RW":"RW 02"},"geometry":{"type":"MultiPolygon","coordinates":[[[[438450.507333887508139,9230490.963042370975018],[438530.120420148421545,9230496.649330442771316],[438592.257431312522385,9230495.258157530799508],[438616.247017840156332,9230499.959009209647775],[438633.168609886197373,9230511.244200060144067],[438704.446065237396397,9230535.03443530574441],[438691.794081555795856,9230566.266297668218613],[438951.946729857765604,9230787.25839146412909],[438973.026485751615837,9230762.975480005145073],[439014.915379690472037,9230714.549445156008005],[439051.700596807058901,9230674.200386110693216],[439151.174367161351256,9230581.84149263985455],[439220.881922895321622,9230518.269638979807496],[439308.225678055780008,9230437.759123854339123],[439385.804042821459007,9230369.326536962762475],[439374.148351874551736,9230335.774903619661927],[439356.526066030317452,9230290.263945115730166],[439340.199878649727907,9230251.707176234573126],[439320.515066462452523,9230205.140314523130655],[439096.981649627443403,9230163.845072424039245],[439088.120532238972373,9230256.231565566733479],[439081.848099670780357,9230278.581213992089033],[439074.833260861458257,9230323.014507247135043],[439063.90425576933194,9230389.451180620118976],[439049.458215327351354,9230444.350691804662347],[439035.219336219073739,9230469.035569993779063],[439029.614425638283137,9230486.419525943696499],[439017.03272360295523,9230565.667091622948647],[438995.53518720692955,9230579.733322318643332],[438990.747056237130892,9230574.446576997637749],[438795.087289917573798,9230514.253748277202249],[438689.972729460801929,9230487.047582067549229],[438623.773847054631915,9230470.9344248380512],[438466.074809118115809,9230438.167195610702038],[438450.507333887508139,9230490.963042370975018]]]]}},{"type":"Feature","properties":{"Id":0,"RW":"RW 04"},"geometry":{"type":"MultiPolygon","coordinates":[[[[438494.957791765220463,9230345.602664384990931],[438637.869353956542909,9230377.038352327421308],[438647.129789143800735,9230391.722756698727608],[439035.219336217269301,9230469.035569991916418],[439049.458215327002108,9230444.350691804662347],[439063.904255770146847,9230389.45118061825633],[438752.471825525164604,9230327.072130858898163],[438513.932406704872847,9230281.986071433871984],[438494.957791765220463,9230345.602664384990931]]]]}}]},
  batasAdmin: {"type":"FeatureCollection","name":"Batas Administrasi Kelurahan","crs":{"type":"name","properties":{"name":"urn:ogc:def:crs:OGC:1.3:CRS84"}},"features":[{"type":"Feature","properties":{"OBJECTID":3251,"NAMOBJ":"Kaligawe","FCODE":"BA03070040","REMARK":"Hasil Pelacakan Batas Kelurahan Tahun 2016-2019","METADATA":"TASWIL1000020230928_DATA_BATAS_DESAKELURAHAN","SRS_ID":"SRGI 2013","KDBBPS":null,"KDCBPS":null,"KDCPUM":"33.74.04","KDEBPS":null,"KDEPUM":"33.74.04.1002","KDPBPS":null,"KDPKAB":"33.74","KDPPUM":"33","LUASWH":83.5347226314,"TIPADM":2,"WADMKC":"Gayamsari","WADMKD":"Kaligawe","WADMKK":"Kota Semarang","WADMPR":"Jawa Tengah","WIADKC":null,"WIADKK":null,"WIADPR":null,"WIADKD":null,"UUPP":"Hasil Sinkronisasi Data Pemerintah Daerah Tahun 2019","Shape_Leng":0.03329987664,"Shape_Area":0.00006835505},"geometry":{"type":"MultiPolygon","coordinates":[[[[110.45155734400004,-6.957086020999952,0],[110.45155733900003,-6.957086385999958,0],[110.45155696300009,-6.957109478999939,0],[110.45155296600007,-6.957262165999964,0],[110.45154486500007,-6.957657247999975,0],[110.45153484900004,-6.958059964999961,0],[110.45152348800008,-6.958784557999934,0],[110.45150184100004,-6.96016517299995,0],[110.45149602900005,-6.960491597999976,0],[110.45148664100009,-6.961018813999942,0],[110.45148549400005,-6.961083216999953,0],[110.45148201900008,-6.961137982999958,0],[110.45146220900006,-6.961450117999959,0],[110.45145436400009,-6.961573705999967,0],[110.45142164000004,-6.961789343999953,0],[110.45138370600006,-6.961994883999978,0],[110.45135161800005,-6.962122507999936,0],[110.45132798000009,-6.962199962999932,0],[110.45130569200006,-6.962280331999978,0],[110.45126808100008,-6.962414740999975,0],[110.45122897500005,-6.962527587999944,0],[110.45115812500006,-6.962732032999952,0],[110.45099811800009,-6.96314351999996,0],[110.45084991700008,-6.963492115999941,0],[110.45078996700005,-6.963633127999969,0],[110.45044473200005,-6.964445186999967,0],[110.45035965000005,-6.964645316999963,0],[110.45012454900007,-6.965214732999925,0],[110.44991097800005,-6.965721653999935,0],[110.44982686400004,-6.96592130099998,0],[110.44959318000008,-6.966465768999967,0],[110.44944214300006,-6.966897629999949,0],[110.44940098400008,-6.967015317999937,0],[110.44934957700008,-6.967187645999957,0],[110.44929657900008,-6.967431537999971,0],[110.44926466500004,-6.967653860999974,0],[110.44925337100005,-6.967732622999961,0],[110.44925322400007,-6.967733658999975,0],[110.44925301500007,-6.967738490999977,0],[110.44904281100008,-6.967729736999956,0],[110.44872003500006,-6.967720314999951,0],[110.44853189600008,-6.967729142999929,0],[110.44845412100005,-6.967710959999977,0],[110.44837917400008,-6.967692780999926,0],[110.44820500400004,-6.967611168999952,0],[110.44804608900006,-6.967547662999948,0],[110.44790722900007,-6.967511319999971,0],[110.44778643100005,-6.967511177999938,0],[110.44770550100009,-6.967529173999935,0],[110.44754789500007,-6.967556126999966,0],[110.44735067200008,-6.967592078999928,0],[110.44717811500004,-6.967582830999959,0],[110.44712917400005,-6.967582773999936,0],[110.44699940800007,-6.967510257999947,0],[110.44676560100004,-6.967383345999963,0],[110.44651169600007,-6.967265456999939,0],[110.44630697400004,-6.967183806999969,0],[110.44615284700006,-6.967138396999928,0],[110.44556037800004,-6.966965838999954,0],[110.44531293800009,-6.966884138999944,0],[110.44505163700006,-6.966802420999954,0],[110.44476259000004,-6.966738762999967,0],[110.44451172400005,-6.966684193999981,0],[110.44383657600008,-6.966574854999976,0],[110.44394556900005,-6.965788016999966,0],[110.44401689500006,-6.965325676999953,0],[110.44294440200008,-6.961815466999951,0],[110.44257334100007,-6.960552538999934,0],[110.44234474600006,-6.959916232999944,0],[110.44251914700004,-6.959843404999958,0],[110.44272856300006,-6.959780332999969,0],[110.44408758000009,-6.959302516999969,0],[110.44485971600005,-6.958959691999951,0],[110.44521856200004,-6.958842519999962,0],[110.44803620500005,-6.957850801999939,0],[110.44951488600009,-6.957364062999943,0],[110.45011280600005,-6.957220028999927,0],[110.45075422700006,-6.95713031799994,0],[110.45150422800003,-6.957085959999972,0],[110.45155734400004,-6.957086020999952,0]]]]}}]},
};  </script>
  <script>
    var kawasanIndustriData = {"type":"FeatureCollection","name":"Kawasan Industri","crs":{"type":"name","properties":{"name":"urn:ogc:def:crs:EPSG::32749"}},"features":[{"type":"Feature","properties":{"Id":0,"RW":"Kawasan Industri"},"geometry":{"type":"MultiPolygon","coordinates":[[[[438920.010329713055398,9230836.587637763470411],[439028.65626086917473,9230875.000017154961824],[439191.937466502480675,9230929.000029930844903],[439257.968784986471292,9230945.000006299465895],[439328.812494661891833,9230954.999997986480594],[439417.5239626627299,9230960.000028841197491],[439417.062921243486926,9230940.526412602514029],[439416.218682028236799,9230896.848552968353033],[439415.163883983856067,9230852.326388094574213],[439414.001784367254004,9230772.22024336643517],[439411.787581450887956,9230619.588696351274848],[439411.187422555056401,9230583.501244366168976],[439410.217998065636493,9230525.215627400204539],[439409.722714306903072,9230512.0407470241189],[439407.574441681208555,9230477.531277157366276],[439406.723698267480358,9230463.867457071319222],[439403.136507753049955,9230440.024199904873967],[439398.972503637429327,9230417.296621134504676],[439395.44428303668974,9230403.183506878092885],[439392.843054318218492,9230394.617724316194654],[439390.391328033467289,9230385.729968121275306],[439386.253886306716595,9230370.866053821519017],[439385.804042821459007,9230369.326536962762475],[439368.04112436354626,9230385.156507914885879],[439361.55545802868437,9230390.975600078701973],[439308.225678055780008,9230437.759123854339123],[439260.542310259421356,9230480.095114247873425],[439220.881922895321622,9230518.269638977944851],[439191.121099987649359,9230543.448754787445068],[439133.587743561540265,9230597.803167110309005],[439094.373065769555978,9230633.615452175959945],[439051.700596807058901,9230674.200386110693216],[439014.915379689075053,9230714.549445156008005],[438973.026485751615837,9230762.975480005145073],[438946.3236962252995,9230793.735868999734521],[438933.049396920891013,9230809.027255985885859],[438928.330747213505674,9230818.229505589231849],[438923.788129147724248,9230827.088461374863982],[438920.010329713055398,9230836.587637763470411]]]]}}]};

    proj4.defs("EPSG:32749", "+proj=utm +zone=49 +south +datum=WGS84 +units=m +no_defs");

    function convertUTMtoWGS84(geojson) {
      var converted = JSON.parse(JSON.stringify(geojson));
      
      function transformCoords(coords) {
        if (typeof coords[0] === 'number') {
          var x = coords[0];
          var y = coords[1];
          if (x > 180 || x < -180 || y > 90 || y < -90) {
            var result = proj4("EPSG:32749", "EPSG:4326", [x, y]);
            return [result[0], result[1]];
          }
          return coords;
        }
        return coords.map(transformCoords);
      }

      converted.features.forEach(function(feature) {
        if (feature.geometry && feature.geometry.coordinates) {
          feature.geometry.coordinates = transformCoords(feature.geometry.coordinates);
        }
      });

      return converted;
    }

    var map = L.map("map").setView([-6.967, 110.447], 15);

    var currentBaseLayer = 'osm';
    var baseLayers = {
      osm: L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
        attribution: '&copy; OpenStreetMap'
      }),
      satellite: L.tileLayer("https://mt1.google.com/vt/lyrs=s&x={x}&y={y}&z={z}", {
        attribution: '&copy; Google'
      }),
      streets: L.tileLayer("https://mt1.google.com/vt/lyrs=m&x={x}&y={y}&z={z}", {
        attribution: '&copy; Google'
      })
    };

    var layerNames = {
      osm: 'OpenStreetMap',
      satellite: 'Satellite',
      streets: 'Streets'
    };

    baseLayers.osm.addTo(map);

    function toggleDropdown() {
      var menu = document.getElementById("dropdown-menu");
      menu.classList.toggle("show");
    }

    function changeLayer(layerName) {
      Object.values(baseLayers).forEach(function(layer) { map.removeLayer(layer); });
      baseLayers[layerName].addTo(map);
      currentBaseLayer = layerName;
      
      document.querySelectorAll('.dropdown-content div').forEach(function(el) { el.classList.remove('active'); });
      document.getElementById('opt-' + layerName).classList.add('active');
      document.getElementById('current-layer-text').textContent = 'Jenis Layer: ' + layerNames[layerName];
      
      document.getElementById("dropdown-menu").classList.remove("show");
    }

    var layers = {
      eksisting: {
        kurang: null,
        cukup: null
      },
      service: {
        1: null,
        2: null,
        3: null
      },
      potensi: {
        kurang: null,
        cukup: null,
        sangat: null
      },
      batas: null,
      rw: null
    };

    var populasiRW = {
      'RW 01': 1394,
      'RW 02': 1435,
      'RW 03': 1268,
      'RW 04': 1252,
      'RW 05': 1154,
      'RW 06': 1392,
      'RW 07': 707,
      'RW 08': 740,
      'RW 09': 496,
      'RW 10': 437
    };

    var rwColors = {
      'RW 01': '#e74c3c',
      'RW 02': '#3498db',
      'RW 03': '#2ecc71',
      'RW 04': '#9b59b6',
      'RW 05': '#f39c12',
      'RW 06': '#1abc9c',
      'RW 07': '#e67e22',
      'RW 08': '#8e44ad',
      'RW 09': '#16a085',
      'RW 10': '#d35400',
      'Kawasan Industri': '#7f8c8d'
    };

    var layerStyles = {
      eksisting: {
        kurang: { color: '#e74c3c', fillColor: '#e74c3c', fillOpacity: 0.5, radius: 8, weight: 2 },
        cukup: { color: '#f1c40f', fillColor: '#f1c40f', fillOpacity: 0.5, radius: 8, weight: 2 }
      },
      service: {
        1: { color: '#e74c3c', fillColor: '#e74c3c', weight: 2, fillOpacity: 0.5 },
        2: { color: '#f1c40f', fillColor: '#f1c40f', weight: 2, fillOpacity: 0.5 },
        3: { color: '#27ae60', fillColor: '#27ae60', weight: 2, fillOpacity: 0.5 }
      },
      potensi: {
        kurang: { color: '#e74c3c', fillColor: '#e74c3c', weight: 2, fillOpacity: 0.5 },
        cukup: { color: '#f1c40f', fillColor: '#f1c40f', weight: 2, fillOpacity: 0.5 },
        sangat: { color: '#27ae60', fillColor: '#27ae60', weight: 2, fillOpacity: 0.5 }
      },
      batas: { color: '#333', weight: 3, fillOpacity: 0, dashArray: '5, 5' }
    };

    function createLayerFromData(data, style, isPoint, needsConversion, onEachFeature) {
      var processedData = needsConversion ? convertUTMtoWGS84(data) : data;
      
      if (isPoint) {
        return L.geoJSON(processedData, {
          pointToLayer: function(feature, latlng) {
            return L.circleMarker(latlng, style);
          },
          onEachFeature: onEachFeature
        });
      }
      return L.geoJSON(processedData, { 
        style: style,
        onEachFeature: onEachFeature
      });
    }

    function createRWLegend() {
      var legendContainer = document.getElementById('rw-legend-items');
      legendContainer.innerHTML = '';
      
      var rwOrder = ['RW 01', 'RW 02', 'RW 03', 'RW 04', 'RW 05', 'RW 06', 'RW 07', 'RW 08', 'RW 09', 'RW 10', 'Kawasan Industri'];
      
      rwOrder.forEach(function(rwName) {
        var color = rwColors[rwName];
        var item = document.createElement('label');
        item.className = 'legend-item';
        var popText = rwName === 'Kawasan Industri' ? '' : ' (' + populasiRW[rwName].toLocaleString('id-ID') + ' jiwa)';
        item.innerHTML = '<div class="color-box" style="background: ' + color + '; opacity: 0.5; border: 2px solid ' + color + ';"></div>' + rwName + popText;
        legendContainer.appendChild(item);
      });
    }

    var layersLoaded = false;

    function initLayers() {
      try {
        layers.eksisting.kurang = createLayerFromData(geoJSONData.umkmKurangSesuai, layerStyles.eksisting.kurang, true, false, null);
        layers.eksisting.cukup = createLayerFromData(geoJSONData.umkmCukupSesuai, layerStyles.eksisting.cukup, true, false, null);

        layers.service['1'] = createLayerFromData(geoJSONData.serviceArea1, layerStyles.service['1'], false, true, null);
        layers.service['2'] = createLayerFromData(geoJSONData.serviceArea2, layerStyles.service['2'], false, true, null);
        layers.service['3'] = createLayerFromData(geoJSONData.serviceArea3, layerStyles.service['3'], false, true, null);

        layers.potensi.kurang = createLayerFromData(geoJSONData.tps3rKurang, layerStyles.potensi.kurang, false, true, null);
        layers.potensi.cukup = createLayerFromData(geoJSONData.tps3rCukup, layerStyles.potensi.cukup, false, true, null);
        layers.potensi.sangat = createLayerFromData(geoJSONData.tps3rSangat, layerStyles.potensi.sangat, false, true, null);

        layers.batas = createLayerFromData(geoJSONData.batasAdmin, layerStyles.batas, false, false, null);

        var rwGroup = L.layerGroup();
        
        var rwData = convertUTMtoWGS84(geoJSONData.batasRW);
        L.geoJSON(rwData, {
          style: function(feature) {
            var rwName = feature.properties.RW;
            var color = rwColors[rwName] || '#3498db';
            return {
              color: color,
              fillColor: color,
              weight: 2,
              fillOpacity: 0.5
            };
          },
          onEachFeature: function(feature, layer) {
            var rwName = feature.properties.RW;
            var populasi = populasiRW[rwName];
            var populasiText = populasi ? populasi.toLocaleString('id-ID') + ' jiwa' : 'Data belum tersedia';
            var color = rwColors[rwName] || '#3498db';
            
            layer.bindPopup(
              '<div style="text-align: center; min-width: 150px;">' +
              '<h3 style="margin: 0 0 10px 0; color: ' + color + '; font-size: 18px;">' + rwName + '</h3>' +
              '<p style="margin: 0; font-size: 14px;"><strong>Jumlah Penduduk:</strong></p>' +
              '<p style="margin: 5px 0 0 0; font-size: 16px; color: #2c3e50;">' + populasiText + '</p>' +
              '</div>'
            );
          }
        }).addTo(rwGroup);

        var kawasanData = convertUTMtoWGS84(kawasanIndustriData);
        L.geoJSON(kawasanData, {
          style: function(feature) {
            var color = rwColors['Kawasan Industri'];
            return {
              color: color,
              fillColor: color,
              weight: 2,
              fillOpacity: 0.5
            };
          },
          onEachFeature: function(feature, layer) {
            layer.bindPopup(
              '<div style="text-align: center; min-width: 150px;">' +
              '<h3 style="margin: 0 0 10px 0; color: #7f8c8d; font-size: 18px;">Kawasan Industri</h3>' +
              '<p style="margin: 0; font-size: 14px;">Area kawasan industri</p>' +
              '</div>'
            );
          }
        }).addTo(rwGroup);

        layers.rw = rwGroup;

        createRWLegend();

        layersLoaded = true;
        console.log('All layers loaded successfully!');
        
        document.getElementById('chk-batas').checked = true;
        document.getElementById('legend-batas').classList.remove('hidden');
        if (layers.batas) {
          map.addLayer(layers.batas);
          map.fitBounds(layers.batas.getBounds());
        }
        
        adjustMapHeight();
        
      } catch (error) {
        console.error('Error initializing layers:', error);
      }
    }

    initLayers();

    function adjustMapHeight() {
      var legendContainer = document.getElementById('legend-container');
      var mapContainer = document.getElementById('map-container');
      
      if (legendContainer && mapContainer) {
        var legendHeight = legendContainer.offsetHeight;
        var mapElement = document.getElementById('map');
        var headerHeight = document.querySelector('#map-container .sub-header').offsetHeight;
        var dropdownMenu = document.getElementById('dropdown-menu');
        var dropdownHeight = dropdownMenu.classList.contains('show') ? dropdownMenu.offsetHeight : 0;
        
        var newMapHeight = legendHeight - headerHeight - dropdownHeight;
        if (newMapHeight > 300) {
          mapElement.style.minHeight = newMapHeight + 'px';
          map.invalidateSize();
        }
      }
    }

    var resizeObserver = new ResizeObserver(function() {
      adjustMapHeight();
    });
    resizeObserver.observe(document.getElementById('legend-container'));

    function togglePeta(petaType) {
      var checkbox = document.getElementById('chk-' + petaType);
      var legendSection = document.getElementById('legend-' + petaType);
      
      if (checkbox.checked) {
        legendSection.classList.remove('hidden');
        Object.keys(layers[petaType]).forEach(function(kelas) {
          var kelasCheckbox = getKelasCheckbox(petaType, kelas);
          if (kelasCheckbox) {
            kelasCheckbox.checked = true;
            if (layers[petaType][kelas]) {
              map.addLayer(layers[petaType][kelas]);
            }
          }
        });
        zoomToLayer(petaType);
      } else {
        legendSection.classList.add('hidden');
        Object.keys(layers[petaType]).forEach(function(kelas) {
          var kelasCheckbox = getKelasCheckbox(petaType, kelas);
          if (kelasCheckbox) {
            kelasCheckbox.checked = false;
          }
          if (layers[petaType][kelas]) {
            map.removeLayer(layers[petaType][kelas]);
          }
        });
      }
      
      adjustMapHeight();
    }

    function toggleBatasAdmin() {
      var checkbox = document.getElementById('chk-batas');
      var legendSection = document.getElementById('legend-batas');
      
      if (checkbox.checked) {
        legendSection.classList.remove('hidden');
        if (layers.batas) {
          map.addLayer(layers.batas);
        }
      } else {
        legendSection.classList.add('hidden');
        if (layers.batas) {
          map.removeLayer(layers.batas);
        }
      }
      
      adjustMapHeight();
    }

    function toggleBatasRW() {
      var checkbox = document.getElementById('chk-rw');
      var legendSection = document.getElementById('legend-rw');
      
      if (checkbox.checked) {
        legendSection.classList.remove('hidden');
        if (layers.rw) {
          map.addLayer(layers.rw);
        }
      } else {
        legendSection.classList.add('hidden');
        if (layers.rw) {
          map.removeLayer(layers.rw);
        }
      }
      
      adjustMapHeight();
    }

    function toggleKelasLayer(petaType, kelas) {
      var checkbox = getKelasCheckbox(petaType, kelas);
      if (checkbox.checked) {
        if (layers[petaType][kelas]) {
          map.addLayer(layers[petaType][kelas]);
        }
      } else {
        if (layers[petaType][kelas]) {
          map.removeLayer(layers[petaType][kelas]);
        }
      }
    }

    function getKelasCheckbox(petaType, kelas) {
      var prefixes = {
        eksisting: 'chk-eks-',
        service: 'chk-srv-',
        potensi: 'chk-pot-'
      };
      return document.getElementById(prefixes[petaType] + kelas);
    }

    function zoomToLayer(layerType) {
      var bounds = null;
      
      if (layerType === 'batas' && layers.batas) {
        bounds = layers.batas.getBounds();
      } else if (layerType === 'rw' && layers.rw) {
        bounds = layers.rw.getBounds();
      } else if (layers[layerType]) {
        var group = L.featureGroup();
        Object.values(layers[layerType]).forEach(function(layer) {
          if (layer) {
            group.addLayer(layer);
          }
        });
        if (group.getLayers().length > 0) {
          bounds = group.getBounds();
        }
      }
      
      if (bounds && bounds.isValid()) {
        map.fitBounds(bounds, { padding: [20, 20] });
      }
    }

    function zoomToKelas(petaType, kelas) {
      if (layers[petaType] && layers[petaType][kelas]) {
        var bounds = layers[petaType][kelas].getBounds();
        if (bounds.isValid()) {
          map.fitBounds(bounds, { padding: [20, 20] });
        }
      }
    }

    var anggotaData = [
      { img: 'a1.jpg', nama: "Raya Nirwanawati", nim: "21110122120023"},
      { foto: "a2.jpg", nama: "Reva Aulia", nim: "21110122130062" },
      { foto: "a3.jpg", nama: "Ahmad Wildan Syauqi", nim: "21110122130074" },
      { foto: "a4.jpg", nama: "Devara Fauzia Fatfa", nim: "21110122130080" },
      { foto: "a5.jpg", nama: "Rangga Tohdjaya", nim: "21110122130083" },
      { foto: "a6.jpg", nama: "Ruben Reiki Indrawansyah", nim: "21110122140134" },
      { foto: "a7.jpg", nama: "Safira Nadifa Azhari", nim: "21110122140161" }
    ];

    function loadAnggota() {
      var row1 = document.getElementById('row1');
      var row2 = document.getElementById('row2');
      
      anggotaList.forEach((anggota, index) => {
      const div = document.createElement('div');
      div.className = 'anggota';
      div.innerHTML = `
        <img class="anggota-img" src="${anggota.foto}" alt="${anggota.nama}" onerror="this.style.background='#d9f2ff'">
        <p>${anggota.nama}</p>
        <p>${anggota.nim}</p>
      `;
      
      if (index < 4) {
        row1.appendChild(div);
      } else {
        row2.appendChild(div);
      }

    loadAnggota();
  </script>
</body>
</html>
